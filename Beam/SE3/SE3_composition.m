function f_3 = SE3_composition(f_1, f_2)

f_3 = zeros(7,1);
f_3(1) = f_1(1) * f_2(1) - f_1(2) * f_2(2) -  f_1(3) * f_2(3) -  f_1(4) * f_2(4);
f_3(2) = f_1(1) * f_2(2) + f_1(2) * f_2(1) +  f_1(3) * f_2(4) -  f_1(4) * f_2(3);
f_3(3) = f_1(1) * f_2(3) + f_1(3) * f_2(1) +  f_1(4) * f_2(2) -  f_1(2) * f_2(4);
f_3(4) = f_1(1) * f_2(4) + f_1(4) * f_2(1) +  f_1(2) * f_2(3) -  f_1(3) * f_2(2);

% f_3(5:7) = f_1(5:7) +...
%     (eye(3) + 2.0 * f_1(1) * skew(f_1(2:4)) + 2.0 * skew(f_1(2:4)) * skew(f_1(2:4))) * f_2(5:7);

skq = skew(f_1(2:4));
y = 2.0 * (skq * f_2(5:7));
f_3(5:7) = f_1(5:7) +  f_2(5:7) + f_1(1) * y  + skq * y;

end
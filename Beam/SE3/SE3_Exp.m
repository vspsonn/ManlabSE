function f = SE3_Exp(p)

f = zeros(7, 1);
f(1) = sqrt(1.0 - 0.25 * (p(4:6)' * p(4:6)));
f(2:4) = 0.5 * p(4:6);
f(5:7) = (eye(3)/f(1) - 0.5 * skew(p(4:6)) + 0.25/f(1) * skew(p(4:6)) * skew(p(4:6)))' * p(1:3);

% f(2:4) = 0.5 * p(4:6);
% f(1) = 1.0 - f(2:4)' * f(2:4);
% 
% skp = skew(f(2:4));
% y = skp * p(1:3);
% f(5:7) = p(1:3)/f(1) + y + skp * (y / f(1));

end